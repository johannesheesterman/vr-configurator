var e={438:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequest=void 0;var o=r(537),n=r(96),i=function(){function e(t,r,n){void 0===r&&(r=new o.DefaultCrypto),void 0===n&&(n=!0),this.crypto=r,this.usePkce=n,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||function(e){return e.generateRandom(10)}(r),this.extras=t.extras,this.internal=t.internal}return e.prototype.setupCodeVerifier=function(){var e=this;if(this.usePkce){var t=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(t).catch((function(e){n.log("Unable to generate PKCE challenge. Not using PKCE",e)})).then((function(r){r&&(e.internal=e.internal||{},e.internal.code_verifier=t,e.extras=e.extras||{},e.extras.code_challenge=r,e.extras.code_challenge_method="S256")}))}return Promise.resolve()},e.prototype.toJson=function(){var e=this;return this.setupCodeVerifier().then((function(){return{response_type:e.responseType,client_id:e.clientId,redirect_uri:e.redirectUri,scope:e.scope,state:e.state,extras:e.extras,internal:e.internal}}))},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();t.AuthorizationRequest=i},960:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequestHandler=t.BUILT_IN_PARAMETERS=t.AuthorizationNotifier=void 0;var o=r(96),n=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,r){this.listener&&this.listener(e,t,r)},e}();t.AuthorizationNotifier=n,t.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var i=function(){function e(e,t){this.utils=e,this.crypto=t,this.notifier=null}return e.prototype.buildRequestUrl=function(e,r){var o={redirect_uri:r.redirectUri,client_id:r.clientId,response_type:r.responseType,state:r.state,scope:r.scope};if(r.extras)for(var n in r.extras)r.extras.hasOwnProperty(n)&&t.BUILT_IN_PARAMETERS.indexOf(n)<0&&(o[n]=r.extras[n]);var i=this.utils.stringify(o);return e.authorizationEndpoint+"?"+i},e.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return o.log("Checking to see if there is an authorization response to be delivered."),this.notifier||o.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then((function(t){t||o.log("No result is available yet."),t&&e.notifier&&e.notifier.onAuthorizationComplete(t.request,t.response,t.error)}))},e.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},e}();t.AuthorizationRequestHandler=i},208:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationError=t.AuthorizationResponse=void 0;var r=function(){function e(e){this.code=e.code,this.state=e.state}return e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();t.AuthorizationResponse=r;var o=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri,this.state=e.state}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();t.AuthorizationError=o},373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationServiceConfiguration=void 0;var o=r(157),n=function(){function e(e){this.authorizationEndpoint=e.authorization_endpoint,this.tokenEndpoint=e.token_endpoint,this.revocationEndpoint=e.revocation_endpoint,this.userInfoEndpoint=e.userinfo_endpoint,this.endSessionEndpoint=e.end_session_endpoint}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,r){var n=t+"/.well-known/openid-configuration";return(r||new o.JQueryRequestor).xhr({url:n,dataType:"json",method:"GET"}).then((function(t){return new e(t)}))},e}();t.AuthorizationServiceConfiguration=n},537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCrypto=t.textEncodeLite=t.urlSafe=t.bufferToString=void 0;var o=r(742),n=r(3),i="undefined"!=typeof window&&!!window.crypto,s=i&&!!window.crypto.subtle,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function u(e){for(var t=[],r=0;r<e.byteLength;r+=1){var o=e[r]%a.length;t.push(a[o])}return t.join("")}function c(e){return o.fromByteArray(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function h(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);return r}t.bufferToString=u,t.urlSafe=c,t.textEncodeLite=h;var l=function(){function e(){}return e.prototype.generateRandom=function(e){var t=new Uint8Array(e);if(i)window.crypto.getRandomValues(t);else for(var r=0;r<e;r+=1)t[r]=Math.random()*a.length|0;return u(t)},e.prototype.deriveChallenge=function(e){return e.length<43||e.length>128?Promise.reject(new n.AppAuthError("Invalid code length.")):s?new Promise((function(t,r){crypto.subtle.digest("SHA-256",h(e)).then((function(e){return t(c(new Uint8Array(e)))}),(function(e){return r(e)}))})):Promise.reject(new n.AppAuthError("window.crypto.subtle is unavailable."))},e}();t.DefaultCrypto=l},3:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppAuthError=void 0;t.AppAuthError=function(e,t){this.message=e,this.extras=t}},577:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IS_PROFILE=t.IS_LOG=void 0,t.IS_LOG=!0,t.IS_PROFILE=!1},865:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(438),t),n(r(960),t),n(r(208),t),n(r(373),t),n(r(537),t),n(r(3),t),n(r(577),t),n(r(96),t),n(r(629),t),n(r(417),t),n(r(33),t),n(r(480),t),n(r(892),t),n(r(551),t),n(r(298),t),n(r(53),t),n(r(157),t)},96:function(e,t,r){var o=this&&this.__spreadArray||function(e,t){for(var r=0,o=t.length,n=e.length;r<o;r++,n++)e[n]=t[r];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.profile=t.log=void 0;var n=r(577);function i(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n.IS_LOG){var i=t?t.length:0;i>0?console.log.apply(console,o([e],t)):console.log(e)}}t.log=i;var s="undefined"!=typeof window&&!!window.performance&&!!console.profile;t.profile=function(e,t,r){return n.IS_PROFILE?function(e,t,r){var n=r.value,a=n.name;return a||(a="anonymous function"),r.value=s?function(e){console.profile(a);var t=window.performance.now(),r=n.call.apply(n,o([this||window],e)),i=window.performance.now()-t;return console.log(a+" took "+i+" ms"),console.profileEnd(),r}:function(e){i("Profile start "+a);var t=Date.now(),r=n.call.apply(n,o([this||window],e)),s=Date.now()-t;return i("Profile end "+a+" took "+s+" ms."),r},r}(0,0,r):r}},629:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasicQueryStringUtils=void 0;var r=function(){function e(){}return e.prototype.parse=function(e,t){return t?this.parseQueryString(e.hash):this.parseQueryString(e.search)},e.prototype.parseQueryString=function(e){for(var t={},r=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),o=0;o<r.length;o+=1){var n=r[o].split("=");if(n.length>=2){var i=decodeURIComponent(n.shift()),s=n.length>0?n.join("="):null;s&&(t[i]=decodeURIComponent(s))}}return t},e.prototype.stringify=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&e[r]&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")},e}();t.BasicQueryStringUtils=r},417:function(e,t,r){var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectRequestHandler=void 0;var i=r(438),s=r(960),a=r(208),u=r(537),c=r(96),h=r(629),l=r(480),p=function(e){return e+"_appauth_authorization_request"},d=function(e){return e+"_appauth_authorization_service_configuration"},f="appauth_current_authorization_request",v=function(e){function t(t,r,o,n){void 0===t&&(t=new l.LocalStorageBackend),void 0===r&&(r=new h.BasicQueryStringUtils),void 0===o&&(o=window.location),void 0===n&&(n=new u.DefaultCrypto);var i=e.call(this,r,n)||this;return i.storageBackend=t,i.locationLike=o,i}return n(t,e),t.prototype.performAuthorizationRequest=function(e,t){var r=this,o=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem(f,o),t.toJson().then((function(e){return r.storageBackend.setItem(p(o),JSON.stringify(e))})),this.storageBackend.setItem(d(o),JSON.stringify(e.toJson()))]).then((function(){var o=r.buildRequestUrl(e,t);c.log("Making a request to ",t,o),r.locationLike.assign(o)}))},t.prototype.completeAuthorizationRequest=function(){var e=this;return this.storageBackend.getItem(f).then((function(t){return t?e.storageBackend.getItem(p(t)).then((function(e){return JSON.parse(e)})).then((function(e){return new i.AuthorizationRequest(e)})).then((function(r){var o=""+e.locationLike.origin+e.locationLike.pathname,n=e.utils.parse(e.locationLike,!0),i=n.state,s=n.code,u=n.error;c.log("Potential authorization request ",o,n,i,s,u);var h=i===r.state,l=null,v=null;if(h){if(u){var _=n.error_uri,y=n.error_description;v=new a.AuthorizationError({error:u,error_description:y,error_uri:_,state:i})}else l=new a.AuthorizationResponse({code:s,state:i});return Promise.all([e.storageBackend.removeItem(f),e.storageBackend.removeItem(p(t)),e.storageBackend.removeItem(d(t))]).then((function(){return c.log("Delivering authorization response"),{request:r,response:l,error:v}}))}return c.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null)})):null}))},t}(s.AuthorizationRequestHandler);t.RedirectRequestHandler=v},33:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RevokeTokenRequest=void 0;var r=function(){function e(e){this.token=e.token,this.tokenTypeHint=e.token_type_hint,this.clientId=e.client_id,this.clientSecret=e.client_secret}return e.prototype.toJson=function(){var e={token:this.token};return this.tokenTypeHint&&(e.token_type_hint=this.tokenTypeHint),this.clientId&&(e.client_id=this.clientId),this.clientSecret&&(e.client_secret=this.clientSecret),e},e.prototype.toStringMap=function(){return this.toJson()},e}();t.RevokeTokenRequest=r},480:function(e,t){var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageBackend=t.StorageBackend=void 0;var n=function(){};t.StorageBackend=n;var i=function(e){function t(t){var r=e.call(this)||this;return r.storage=t||window.localStorage,r}return o(t,e),t.prototype.getItem=function(e){var t=this;return new Promise((function(r,o){r(t.storage.getItem(e)||null)}))},t.prototype.removeItem=function(e){var t=this;return new Promise((function(r,o){t.storage.removeItem(e),r()}))},t.prototype.clear=function(){var e=this;return new Promise((function(t,r){e.storage.clear(),t()}))},t.prototype.setItem=function(e,t){var r=this;return new Promise((function(o,n){r.storage.setItem(e,t),o()}))},t}(n);t.LocalStorageBackend=i},892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequest=t.GRANT_TYPE_REFRESH_TOKEN=t.GRANT_TYPE_AUTHORIZATION_CODE=void 0,t.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",t.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var r=function(){function e(e){this.clientId=e.client_id,this.redirectUri=e.redirect_uri,this.grantType=e.grant_type,this.code=e.code,this.refreshToken=e.refresh_token,this.extras=e.extras}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e}();t.TokenRequest=r},551:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTokenRequestHandler=void 0;var o=r(3),n=r(629),i=r(298),s=r(157),a=function(){function e(e,t){void 0===e&&(e=new s.JQueryRequestor),void 0===t&&(t=new n.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return!0}))},e.prototype.performTokenRequest=function(e,t){var r=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return r.isTokenResponse(e)?new i.TokenResponse(e):Promise.reject(new o.AppAuthError(e.error,new i.TokenError(e)))}))},e}();t.BaseTokenRequestHandler=a},298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=t.TokenResponse=t.nowInSeconds=void 0,t.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var r=function(){function e(e){this.accessToken=e.access_token,this.tokenType=e.token_type||"bearer",e.expires_in&&(this.expiresIn=parseInt(e.expires_in,10)),this.refreshToken=e.refresh_token,this.scope=e.scope,this.idToken=e.id_token,this.issuedAt=e.issued_at||t.nowInSeconds()}return e.prototype.toJson=function(){var e;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:null===(e=this.expiresIn)||void 0===e?void 0:e.toString()}},e.prototype.isValid=function(e){return void 0===e&&(e=-600),!this.expiresIn||t.nowInSeconds()<this.issuedAt+this.expiresIn+e},e}();t.TokenResponse=r;var o=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();t.TokenError=o},53:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},157:function(e,t,r){var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.TestRequestor=t.FetchRequestor=t.JQueryRequestor=t.Requestor=void 0;var i=r(3),s=function(){};t.Requestor=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise((function(e,r){t.then((function(t,r,o){e(t)}),(function(e,t,o){r(new i.AppAuthError(o))}))}))},t}(s);t.JQueryRequestor=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.xhr=function(e){if(!e.url)return Promise.reject(new i.AppAuthError("A URL must be provided."));var t=new URL(e.url),r={};if(r.method=e.method,r.mode="cors",e.data&&(e.method&&"POST"===e.method.toUpperCase()?r.body=e.data:new URLSearchParams(e.data).forEach((function(e,r){t.searchParams.append(r,e)}))),r.headers={},e.headers)for(var o in e.headers)e.headers.hasOwnProperty(o)&&(r.headers[o]=e.headers[o]);var n=e.dataType&&"json"===e.dataType.toLowerCase();return n&&(r.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(t.toString(),r).then((function(e){if(e.status>=200&&e.status<300){var t=e.headers.get("content-type");return n||t&&-1!==t.indexOf("application/json")?e.json():e.text()}return Promise.reject(new i.AppAuthError(e.status.toString(),e.statusText))}))},t}(s);t.FetchRequestor=u;var c=function(e){function t(t){var r=e.call(this)||this;return r.promise=t,r}return n(t,e),t.prototype.xhr=function(e){return this.promise},t}(s);t.TestRequestor=c},742:(e,t)=>{t.byteLength=function(e){var t=u(e),r=t[0],o=t[1];return 3*(r+o)/4-o},t.toByteArray=function(e){var t,r,i=u(e),s=i[0],a=i[1],c=new n(function(e,t,r){return 3*(t+r)/4-r}(0,s,a)),h=0,l=a>0?s-4:s;for(r=0;r<l;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],c[h++]=t>>16&255,c[h++]=t>>8&255,c[h++]=255&t;return 2===a&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,c[h++]=255&t),1===a&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,c[h++]=t>>8&255,c[h++]=255&t),c},t.fromByteArray=function(e){for(var t,o=e.length,n=o%3,i=[],s=16383,a=0,u=o-n;a<u;a+=s)i.push(c(e,a,a+s>u?u:a+s));return 1===n?(t=e[o-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[o-2]<<8)+e[o-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],o=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=i.length;s<a;++s)r[s]=i[s],o[i.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,o){for(var n,i,s=[],a=t;a<o;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(i=n)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return s.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},202:function(e,t,r){var o=this&&this.__awaiter||function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function s(e){try{u(o.next(e))}catch(e){i(e)}}function a(e){try{u(o.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationContext=void 0;const n=r(373),i=r(438),s=r(417),a=r(892),u=r(865),c=r(514);t.AuthenticationContext=class{constructor(e){this.options=e,this.loginUrl="https://login.elfsquad.io",this.onSignInResolvers=[],this.onSignInRejectors=[],this.signedInResolvers=[],this.isInitialized=!1,e?e.clientId?e.redirectUri?(e.scope||(e.scope="Elfskot.Api offline_access"),e.loginUrl&&(this.loginUrl=e.loginUrl),this.fetchRequestor=new u.FetchRequestor,this.tokenHandler=new u.BaseTokenRequestHandler(this.fetchRequestor),this.authorizationHandler=new h,this.initialize()):console.error("No redirect uri provided"):console.error("No client id provided"):console.error("No authentication options were provided")}onSignIn(){return new Promise(((e,t)=>{this.onSignInResolvers.push(e),this.onSignInRejectors.push(t)}))}signIn(){return o(this,void 0,void 0,(function*(){yield this.fetchConfiguration(),this.makeAuthorizationRequest()}))}signOut(){this.deleteTokens(),location.href=`${this.loginUrl}/logout`}deleteTokens(){this.accessTokenResponse=null,c.TokenStore.deleteRefreshToken()}isSignedIn(){return new Promise(((e,t)=>{this.isInitialized?e(this.validateAccessTokenResponse()):this.signedInResolvers.push(e)}))}getAccessToken(){return this.configuration?this.accessTokenResponse&&this.accessTokenResponse.isValid()?Promise.resolve(this.accessTokenResponse.accessToken):c.TokenStore.hasRefreshToken()?this.refreshAccessToken():Promise.reject("Missing refreshToken."):Promise.reject("Unknown service configuration")}getIdToken(){return o(this,void 0,void 0,(function*(){return this.configuration?this.accessTokenResponse&&this.accessTokenResponse.isValid()?Promise.resolve(this.accessTokenResponse.idToken):c.TokenStore.hasRefreshToken()?(yield this.refreshAccessToken(),Promise.resolve(this.accessTokenResponse.idToken)):Promise.reject("Missing refreshToken."):Promise.reject("Unknown service configuration")}))}validateAccessTokenResponse(){return!!this.accessTokenResponse&&this.accessTokenResponse.isValid()}refreshAccessToken(){return o(this,void 0,void 0,(function*(){const e=new a.TokenRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,grant_type:a.GRANT_TYPE_REFRESH_TOKEN,code:void 0,refresh_token:c.TokenStore.getRefreshToken(),extras:void 0}),t=yield this.tokenHandler.performTokenRequest(this.configuration,e);return this.accessTokenResponse=t,console.log("refreshAccessToken response",this.accessTokenResponse),c.TokenStore.saveRefreshToken(t.refreshToken),t.accessToken}))}fetchConfiguration(){return o(this,void 0,void 0,(function*(){this.configuration||(this.configuration=yield n.AuthorizationServiceConfiguration.fetchFromIssuer(this.loginUrl,this.fetchRequestor))}))}makeAuthorizationRequest(){const e=new i.AuthorizationRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,scope:this.options.scope,response_type:i.AuthorizationRequest.RESPONSE_TYPE_CODE,state:void 0,extras:{access_type:"offline",response_mode:"fragment"}});this.authorizationHandler.performAuthorizationRequest(this.configuration,e)}onAuthorization(e,t,r){var n;return o(this,void 0,void 0,(function*(){if(location.hash="",r){for(let e of this.onSignInRejectors)e(r);return}if(!t)return;let o=new a.TokenRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,grant_type:a.GRANT_TYPE_AUTHORIZATION_CODE,code:t.code,refresh_token:void 0});(null===(n=e.internal)||void 0===n?void 0:n.code_verifier)&&(o.extras={code_verifier:e.internal.code_verifier}),this.configuration||(yield this.fetchConfiguration()),this.accessTokenResponse=yield this.tokenHandler.performTokenRequest(this.configuration,o),c.TokenStore.saveRefreshToken(this.accessTokenResponse.refreshToken),this.callOnSigInResolvers()}))}initialize(){return o(this,void 0,void 0,(function*(){if(c.TokenStore.hasRefreshToken())return console.log("hasRefreshToken"),yield this.fetchConfiguration(),void this.refreshAccessToken().then((()=>{this.callOnSigInResolvers()})).catch((e=>{console.error("Failed to refresh access token",e),this.deleteTokens()})).finally((()=>{this.callSignedInResolvers()}));this.completeAuthorizationRequest()}))}completeAuthorizationRequest(){this.authorizationHandler.completeAuthorizationRequest().then((e=>o(this,void 0,void 0,(function*(){this.isInitialized=!0,e&&(yield this.onAuthorization(e.request,e.response,e.error)),this.callSignedInResolvers()}))))}callSignedInResolvers(){for(let e of this.signedInResolvers)e(this.validateAccessTokenResponse())}callOnSigInResolvers(){for(let e of this.onSignInResolvers)e()}};class h extends s.RedirectRequestHandler{completeAuthorizationRequest(){return super.completeAuthorizationRequest()}}},514:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenStore=void 0;class r{static hasRefreshToken(){return!!localStorage.getItem(this.REFRESH_TOKEN_KEY)}static getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}static saveRefreshToken(e){localStorage.setItem(this.REFRESH_TOKEN_KEY,e)}static deleteRefreshToken(){localStorage.removeItem(this.REFRESH_TOKEN_KEY)}}t.TokenStore=r,r.REFRESH_TOKEN_KEY="elfsquad_refresh_token"}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}var o={};(()=>{var e=o;Object.defineProperty(e,"X",{value:!0}),e.z=void 0;var t=r(202);Object.defineProperty(e,"z",{enumerable:!0,get:function(){return t.AuthenticationContext}})})();var n=o.z,i=o.X;export{n as AuthenticationContext,i as __esModule};